<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Sunsun Intelligence Console</title>
    <style>
        :root { --tel-blue: #00a1e9; --tel-green: #8cc63f; --bg: #f5f7fa; }
        body { font-family: -apple-system, sans-serif; margin: 0; padding: 10px; background: var(--bg); min-height: 100vh; }
        
        /* 天気バー */
        .weather-panel { background: white; padding: 12px; border-radius: 10px; margin-bottom: 15px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); font-size: 0.85rem; border-top: 4px solid var(--tel-blue); }

        /* スンスンSVG（右下固定） */
        #sunsun-fixed { position: fixed; bottom: 20px; right: 20px; width: 80px; height: 80px; z-index: 9999; filter: drop-shadow(0 4px 6px rgba(0,0,0,0.2)); }

        .section { background: rgba(255,255,255,0.95); border-radius: 12px; padding: 15px; margin-bottom: 20px; box-shadow: 0 4px 12px rgba(0,0,0,0.05); }
        h2 { font-size: 0.8rem; color: var(--tel-blue); border-left: 5px solid var(--tel-green); padding-left: 10px; margin-top: 0; }

        /* ロジックアーカイブ */
        .input-group { display: flex; flex-direction: column; gap: 8px; }
        input { padding: 12px; border: 1px solid #ddd; border-radius: 8px; font-size: 16px; -webkit-appearance: none; }
        .save-btn { background: linear-gradient(135deg, var(--tel-blue), var(--tel-green)); color: white; border: none; padding: 15px; border-radius: 8px; font-weight: bold; margin-top: 5px; }
        
        #archive-list { margin-top: 15px; display: flex; flex-direction: column; gap: 10px; }
        .log-card { background: #fff; border: 1px solid #eee; padding: 10px; border-radius: 8px; font-size: 0.8rem; position: relative; }
        .log-time { color: var(--tel-blue); font-weight: bold; margin-right: 8px; }
        .log-person { color: #666; font-style: italic; display: block; margin-top: 4px; border-top: 1px dashed #eee; padding-top: 4px; }

        /* 背景ポケモン */
        #pk-bg { position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); width: 70%; opacity: 0.3; z-index: -1; pointer-events: none; }
    </style>
</head>
<body>

<div class="weather-panel" id="weather-box">天気情報を同期中...</div>

<img id="pk-bg" src="">

<div id="sunsun-fixed">
    <svg viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
        <circle cx="50" cy="50" r="45" fill="white" stroke="#333" stroke-width="2"/>
        <circle cx="35" cy="40" r="5" fill="#333"/>
        <circle cx="65" cy="40" r="5" fill="#333"/>
        <path d="M 30 60 Q 50 80 70 60" fill="none" stroke="#333" stroke-width="3" stroke-linecap="round"/>
        <path d="M 45 45 L 55 45" stroke="pink" stroke-width="4" opacity="0.6"/>
    </svg>
</div>

<div class="section">
    <h2>LOGIC ARCHIVE</h2>
    <div class="input-group">
        <input type="text" id="log-content" placeholder="思考の内容 (THOUGHT)">
        <input type="text" id="log-person" placeholder="人物 (PERSON)">
        <button class="save-btn" onclick="saveLogic()">SAVE TO SEMICONDUCTOR</button>
    </div>
    <div id="archive-list"></div>
</div>

<script>
    // 1. ロジック保存システム（LocalStorageで永続化）
    function saveLogic() {
        const content = document.getElementById('log-content').value;
        const person = document.getElementById('log-person').value;
        if (!content) return;

        const now = new Date();
        const timeStr = `${now.getMonth()+1}/${now.getDate()} ${now.getHours()}:${now.getMinutes().toString().padStart(2,'0')}`;

        const newLog = { content, person: person || "Unknown", time: timeStr };
        
        // 既存ログ取得
        let logs = JSON.parse(localStorage.getItem('sunsun_logs') || '[]');
        logs.unshift(newLog); // 先頭に追加
        localStorage.setItem('sunsun_logs', JSON.stringify(logs));

        renderLogs();
        document.getElementById('log-content').value = '';
        document.getElementById('log-person').value = '';
    }

    function renderLogs() {
        const logs = JSON.parse(localStorage.getItem('sunsun_logs') || '[]');
        const list = document.getElementById('archive-list');
        list.innerHTML = logs.slice(0, 10).map(log => `
            <div class="log-card">
                <span class="log-time">${log.time}</span>
                <strong>${log.content}</strong>
                <span class="log-person">Recorded by: ${log.person}</span>
            </div>
        `).join('');
    }

    // 2. 天気取得
    async function fetchWeather() {
        const rss = 'https://news.google.com/rss/search?q=%E6%9D%B1%E4%BA%AC+%E5%A4%A9%E6%B0%97+%E6%B0%97%E6%B8%A9&hl=ja&gl=JP&ceid=JP:ja';
        try {
            const res = await fetch(`https://api.rss2json.com/v1/api.json?rss_url=${encodeURIComponent(rss)}`);
            const data = await res.json();
            document.getElementById('weather-box').innerHTML = `<b>TODAY'S INTEL:</b> ${data.items[0].title.split(' - ')[0]}`;
        } catch (e) { document.getElementById('weather-box').innerText = "Weather offline."; }
    }

    // 3. ポケモン背景
    function setPk() {
        const id = Math.floor(Math.random() * 649) + 1;
        document.getElementById('pk-bg').src = `https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/other/official-artwork/${id}.png`;
    }

    window.onload = () => {
        renderLogs();
        fetchWeather();
        setPk();
    };
</script>
</body>
</html>
